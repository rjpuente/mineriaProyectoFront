{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport React, { createContext, useEffect, useState } from 'react';\nimport { VoicePilotApi } from \"../api/VoicePilotApi\";\nimport { useNotificationContext } from \"./NotificationContext\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthContext = createContext();\nexport function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isLoading = _useState2[0],\n    setIsLoading = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    userToken = _useState4[0],\n    setUserToken = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    userData = _useState6[0],\n    setUserData = _useState6[1];\n  var _useNotificationConte = useNotificationContext(),\n    setNotification = _useNotificationConte.setNotification;\n  var login = function () {\n    var _ref3 = _asyncToGenerator(function* (_ref2) {\n      var username = _ref2.username,\n        password = _ref2.password;\n      setIsLoading(true);\n      try {\n        var request = yield VoicePilotApi.post('/auth/login', {\n          username: username,\n          password: password\n        });\n        var userInfo = yield request.data;\n        var token = userInfo.token;\n        setUserToken(token);\n        setUserData(userInfo);\n        AsyncStorage.setItem('userInfo', JSON.stringify(userInfo));\n        AsyncStorage.setItem('userToken', token);\n      } catch (error) {\n        if (error.response.status === 401) {\n          setNotification({\n            message: 'Credenciales incorrectas',\n            level: 'error'\n          });\n        } else {\n          setNotification({\n            message: 'Error al iniciar la sesión',\n            level: 'error'\n          });\n        }\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function login(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var logout = function logout() {\n    setIsLoading(true);\n    setUserToken(null);\n    AsyncStorage.removeItem('userToken');\n    AsyncStorage.removeItem('userInfo');\n    setIsLoading(false);\n  };\n  var isLoggedIn = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      try {\n        setIsLoading(true);\n        var _userToken = yield AsyncStorage.getItem('userToken');\n        var userInfo = yield AsyncStorage.getItem('userInfo');\n        var userInfoData = JSON.parse(userInfo);\n        if (userInfoData) {\n          setUserToken(_userToken);\n          setUserData(userInfoData);\n        }\n      } catch (error) {\n        console.log('isLoggedIn error: ', error);\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function isLoggedIn() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var register = function () {\n    var _ref6 = _asyncToGenerator(function* (_ref5) {\n      var username = _ref5.username,\n        password = _ref5.password,\n        email = _ref5.email;\n      setIsLoading(true);\n      try {\n        var request = yield VoicePilotApi.post('/auth/register', {\n          username: username,\n          password: password,\n          email: email\n        });\n        var data = yield request.data;\n        console.log(data);\n        setNotification({\n          message: 'Usuario registrado',\n          level: 'success'\n        });\n      } catch (error) {\n        if (error.response.status === 400) {\n          setNotification({\n            message: 'Usuario ya registrado',\n            level: 'error'\n          });\n        } else {\n          setNotification({\n            message: 'Error al registrar el usuario',\n            level: 'error'\n          });\n        }\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function register(_x2) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    isLoggedIn();\n  }, []);\n  return _jsx(AuthContext.Provider, {\n    value: {\n      login: login,\n      logout: logout,\n      register: register,\n      isLoading: isLoading,\n      userToken: userToken,\n      userData: userData\n    },\n    children: children\n  });\n}","map":{"version":3,"names":["AsyncStorage","React","createContext","useEffect","useState","VoicePilotApi","useNotificationContext","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","userToken","setUserToken","_useState5","_useState6","userData","setUserData","_useNotificationConte","setNotification","login","_ref3","_asyncToGenerator","_ref2","username","password","request","post","userInfo","data","token","setItem","JSON","stringify","error","response","status","message","level","_x","apply","arguments","logout","removeItem","isLoggedIn","_ref4","getItem","userInfoData","parse","console","log","register","_ref6","_ref5","email","_x2","Provider","value"],"sources":["C:/xampp/htdocs/mineriaProyectoFront/src/context/AuthContext.js"],"sourcesContent":["import AsyncStorage from '@react-native-async-storage/async-storage'\r\nimport React, { createContext, useEffect, useState } from 'react'\r\nimport { VoicePilotApi } from '../api/VoicePilotApi'\r\nimport { useNotificationContext } from './NotificationContext'\r\n\r\nexport const AuthContext = createContext()\r\n\r\nexport function AuthProvider ({ children }) {\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [userToken, setUserToken] = useState(null)\r\n  const [userData, setUserData] = useState(null)\r\n  const { setNotification } = useNotificationContext()\r\n\r\n  const login = async ({ username, password }) => {\r\n    setIsLoading(true)\r\n\r\n    try {\r\n      const request = await VoicePilotApi.post('/auth/login', {\r\n        username,\r\n        password\r\n      })\r\n\r\n      const userInfo = await request.data\r\n\r\n      const { token } = userInfo\r\n\r\n      setUserToken(token)\r\n      setUserData(userInfo)\r\n      AsyncStorage.setItem('userInfo', JSON.stringify(userInfo))\r\n      AsyncStorage.setItem('userToken', token)\r\n    } catch (error) {\r\n      if (error.response.status === 401) {\r\n        setNotification({\r\n          message: 'Credenciales incorrectas',\r\n          level: 'error'\r\n        })\r\n      } else {\r\n        setNotification({\r\n          message: 'Error al iniciar la sesión',\r\n          level: 'error'\r\n        })\r\n      }\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  const logout = () => {\r\n    setIsLoading(true)\r\n    setUserToken(null)\r\n    AsyncStorage.removeItem('userToken')\r\n    AsyncStorage.removeItem('userInfo')\r\n    setIsLoading(false)\r\n  }\r\n\r\n  const isLoggedIn = async () => {\r\n    try {\r\n      setIsLoading(true)\r\n      const userToken = await AsyncStorage.getItem('userToken')\r\n      const userInfo = await AsyncStorage.getItem('userInfo')\r\n      const userInfoData = JSON.parse(userInfo)\r\n\r\n      if (userInfoData) {\r\n        setUserToken(userToken)\r\n        setUserData(userInfoData)\r\n      }\r\n    } catch (error) {\r\n      console.log('isLoggedIn error: ', error)\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  const register = async ({ username, password, email }) => {\r\n    setIsLoading(true)\r\n\r\n    try {\r\n      const request = await VoicePilotApi.post('/auth/register', {\r\n        username,\r\n        password,\r\n        email\r\n      })\r\n\r\n      const data = await request.data\r\n\r\n      console.log(data)\r\n      setNotification({\r\n        message: 'Usuario registrado',\r\n        level: 'success'\r\n      })\r\n    } catch (error) {\r\n      if (error.response.status === 400) {\r\n        setNotification({\r\n          message: 'Usuario ya registrado',\r\n          level: 'error'\r\n        })\r\n      } else {\r\n        setNotification({\r\n          message: 'Error al registrar el usuario',\r\n          level: 'error'\r\n        })\r\n      }\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    isLoggedIn()\r\n  }, [])\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ login, logout, register, isLoading, userToken, userData }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  )\r\n}\r\n"],"mappings":";;AAAA,OAAOA,YAAY,MAAM,2CAA2C;AACpE,OAAOC,KAAK,IAAIC,aAAa,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACjE,SAASC,aAAa;AACtB,SAASC,sBAAsB;AAA+B,SAAAC,GAAA,IAAAC,IAAA;AAE9D,OAAO,IAAMC,WAAW,GAAGP,aAAa,CAAC,CAAC;AAE1C,OAAO,SAASQ,YAAYA,CAAAC,IAAA,EAAgB;EAAA,IAAZC,QAAQ,GAAAD,IAAA,CAARC,QAAQ;EACtC,IAAAC,SAAA,GAAkCT,QAAQ,CAAC,KAAK,CAAC;IAAAU,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAA1CG,SAAS,GAAAF,UAAA;IAAEG,YAAY,GAAAH,UAAA;EAC9B,IAAAI,UAAA,GAAkCd,QAAQ,CAAC,IAAI,CAAC;IAAAe,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAAzCE,SAAS,GAAAD,UAAA;IAAEE,YAAY,GAAAF,UAAA;EAC9B,IAAAG,UAAA,GAAgClB,QAAQ,CAAC,IAAI,CAAC;IAAAmB,UAAA,GAAAR,cAAA,CAAAO,UAAA;IAAvCE,QAAQ,GAAAD,UAAA;IAAEE,WAAW,GAAAF,UAAA;EAC5B,IAAAG,qBAAA,GAA4BpB,sBAAsB,CAAC,CAAC;IAA5CqB,eAAe,GAAAD,qBAAA,CAAfC,eAAe;EAEvB,IAAMC,KAAK;IAAA,IAAAC,KAAA,GAAAC,iBAAA,CAAG,WAAAC,KAAA,EAAkC;MAAA,IAAzBC,QAAQ,GAAAD,KAAA,CAARC,QAAQ;QAAEC,QAAQ,GAAAF,KAAA,CAARE,QAAQ;MACvChB,YAAY,CAAC,IAAI,CAAC;MAElB,IAAI;QACF,IAAMiB,OAAO,SAAS7B,aAAa,CAAC8B,IAAI,CAAC,aAAa,EAAE;UACtDH,QAAQ,EAARA,QAAQ;UACRC,QAAQ,EAARA;QACF,CAAC,CAAC;QAEF,IAAMG,QAAQ,SAASF,OAAO,CAACG,IAAI;QAEnC,IAAQC,KAAK,GAAKF,QAAQ,CAAlBE,KAAK;QAEbjB,YAAY,CAACiB,KAAK,CAAC;QACnBb,WAAW,CAACW,QAAQ,CAAC;QACrBpC,YAAY,CAACuC,OAAO,CAAC,UAAU,EAAEC,IAAI,CAACC,SAAS,CAACL,QAAQ,CAAC,CAAC;QAC1DpC,YAAY,CAACuC,OAAO,CAAC,WAAW,EAAED,KAAK,CAAC;MAC1C,CAAC,CAAC,OAAOI,KAAK,EAAE;QACd,IAAIA,KAAK,CAACC,QAAQ,CAACC,MAAM,KAAK,GAAG,EAAE;UACjCjB,eAAe,CAAC;YACdkB,OAAO,EAAE,0BAA0B;YACnCC,KAAK,EAAE;UACT,CAAC,CAAC;QACJ,CAAC,MAAM;UACLnB,eAAe,CAAC;YACdkB,OAAO,EAAE,4BAA4B;YACrCC,KAAK,EAAE;UACT,CAAC,CAAC;QACJ;MACF,CAAC,SAAS;QACR7B,YAAY,CAAC,KAAK,CAAC;MACrB;IACF,CAAC;IAAA,gBAhCKW,KAAKA,CAAAmB,EAAA;MAAA,OAAAlB,KAAA,CAAAmB,KAAA,OAAAC,SAAA;IAAA;EAAA,GAgCV;EAED,IAAMC,MAAM,GAAG,SAATA,MAAMA,CAAA,EAAS;IACnBjC,YAAY,CAAC,IAAI,CAAC;IAClBI,YAAY,CAAC,IAAI,CAAC;IAClBrB,YAAY,CAACmD,UAAU,CAAC,WAAW,CAAC;IACpCnD,YAAY,CAACmD,UAAU,CAAC,UAAU,CAAC;IACnClC,YAAY,CAAC,KAAK,CAAC;EACrB,CAAC;EAED,IAAMmC,UAAU;IAAA,IAAAC,KAAA,GAAAvB,iBAAA,CAAG,aAAY;MAC7B,IAAI;QACFb,YAAY,CAAC,IAAI,CAAC;QAClB,IAAMG,UAAS,SAASpB,YAAY,CAACsD,OAAO,CAAC,WAAW,CAAC;QACzD,IAAMlB,QAAQ,SAASpC,YAAY,CAACsD,OAAO,CAAC,UAAU,CAAC;QACvD,IAAMC,YAAY,GAAGf,IAAI,CAACgB,KAAK,CAACpB,QAAQ,CAAC;QAEzC,IAAImB,YAAY,EAAE;UAChBlC,YAAY,CAACD,UAAS,CAAC;UACvBK,WAAW,CAAC8B,YAAY,CAAC;QAC3B;MACF,CAAC,CAAC,OAAOb,KAAK,EAAE;QACde,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEhB,KAAK,CAAC;MAC1C,CAAC,SAAS;QACRzB,YAAY,CAAC,KAAK,CAAC;MACrB;IACF,CAAC;IAAA,gBAhBKmC,UAAUA,CAAA;MAAA,OAAAC,KAAA,CAAAL,KAAA,OAAAC,SAAA;IAAA;EAAA,GAgBf;EAED,IAAMU,QAAQ;IAAA,IAAAC,KAAA,GAAA9B,iBAAA,CAAG,WAAA+B,KAAA,EAAyC;MAAA,IAAhC7B,QAAQ,GAAA6B,KAAA,CAAR7B,QAAQ;QAAEC,QAAQ,GAAA4B,KAAA,CAAR5B,QAAQ;QAAE6B,KAAK,GAAAD,KAAA,CAALC,KAAK;MACjD7C,YAAY,CAAC,IAAI,CAAC;MAElB,IAAI;QACF,IAAMiB,OAAO,SAAS7B,aAAa,CAAC8B,IAAI,CAAC,gBAAgB,EAAE;UACzDH,QAAQ,EAARA,QAAQ;UACRC,QAAQ,EAARA,QAAQ;UACR6B,KAAK,EAALA;QACF,CAAC,CAAC;QAEF,IAAMzB,IAAI,SAASH,OAAO,CAACG,IAAI;QAE/BoB,OAAO,CAACC,GAAG,CAACrB,IAAI,CAAC;QACjBV,eAAe,CAAC;UACdkB,OAAO,EAAE,oBAAoB;UAC7BC,KAAK,EAAE;QACT,CAAC,CAAC;MACJ,CAAC,CAAC,OAAOJ,KAAK,EAAE;QACd,IAAIA,KAAK,CAACC,QAAQ,CAACC,MAAM,KAAK,GAAG,EAAE;UACjCjB,eAAe,CAAC;YACdkB,OAAO,EAAE,uBAAuB;YAChCC,KAAK,EAAE;UACT,CAAC,CAAC;QACJ,CAAC,MAAM;UACLnB,eAAe,CAAC;YACdkB,OAAO,EAAE,+BAA+B;YACxCC,KAAK,EAAE;UACT,CAAC,CAAC;QACJ;MACF,CAAC,SAAS;QACR7B,YAAY,CAAC,KAAK,CAAC;MACrB;IACF,CAAC;IAAA,gBAhCK0C,QAAQA,CAAAI,GAAA;MAAA,OAAAH,KAAA,CAAAZ,KAAA,OAAAC,SAAA;IAAA;EAAA,GAgCb;EAED9C,SAAS,CAAC,YAAM;IACdiD,UAAU,CAAC,CAAC;EACd,CAAC,EAAE,EAAE,CAAC;EAEN,OACE5C,IAAA,CAACC,WAAW,CAACuD,QAAQ;IAACC,KAAK,EAAE;MAAErC,KAAK,EAALA,KAAK;MAAEsB,MAAM,EAANA,MAAM;MAAES,QAAQ,EAARA,QAAQ;MAAE3C,SAAS,EAATA,SAAS;MAAEI,SAAS,EAATA,SAAS;MAAEI,QAAQ,EAARA;IAAS,CAAE;IAAAZ,QAAA,EACtFA;EAAQ,CACW,CAAC;AAE3B"},"metadata":{},"sourceType":"module","externalDependencies":[]}